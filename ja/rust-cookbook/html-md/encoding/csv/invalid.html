<!DOCTYPE html>
<h2>Handle invalid CSV data with Serde</h2>
<br>
<p><a href="#3csv">!<a class="notranslate" href="#4csv-badge">csv-badge</a></a> <a href="#3serde">!<a class="notranslate" href="#4serde-badge">serde-badge</a></a> <a href="#3cat-encoding">!<a class="notranslate" href="#4cat-encoding-badge">cat-encoding-badge</a></a></p>
<br>
<p>CSV files often contain invalid data. For these cases, the <code>csv</code> crate
provides a custom deserializer, <a class="notranslate" href="#4`csv::invalid_option`">`csv::invalid_option`</a>, which automatically
converts invalid data to None values.</p>
<br>
<div data-lang="rust"><div data-l="# #[macro_use]"></div><div data-l="# extern crate error_chain;"></div><div data-l="extern crate csv;"></div><div data-l="#[macro_use]"></div><div data-l="extern crate serde_derive;"></div><div data-l=""></div><div data-l="#[derive(Debug, Deserialize)]"></div><div data-l="struct Record {"></div><div data-l="    name: String,"></div><div data-l="    place: String,"></div><div data-l="    #[serde(deserialize_with = &quot;csv::invalid_option&quot;)]"></div><div data-l="    id: Option&lt;u64&gt;,"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# error_chain! {"></div><div data-l="#     foreign_links {"></div><div data-l="#         CsvError(csv::Error);"></div><div data-l="#     }"></div><div data-l="# }"></div><div data-l=""></div><div data-l="fn run() -&gt; Result&lt;()&gt; {"></div><div data-l="    let data = &quot;name,place,id"></div><div data-l="mark,sydney,46.5"></div><div data-l="ashley,zurich,92"></div><div data-l="akshat,delhi,37"></div><div data-l="alisha,colombo,xyz&quot;;"></div><div data-l=""></div><div data-l="    let mut rdr = csv::Reader::from_reader(data.as_bytes());"></div><div data-l="    for result in rdr.deserialize() {"></div><div data-l="        let record: Record = result?;"></div><div data-l="        println!(&quot;{:?}&quot;, record);"></div><div data-l="    }"></div><div data-l=""></div><div data-l="    Ok(())"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# quick_main!(run);"></div></div>
<br>
<a class="notranslate" href="#1https://docs.rs/csv/*/csv/fn.invalid_option.html">`csv::invalid_option`</a>