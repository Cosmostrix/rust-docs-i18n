<!DOCTYPE html>
<h2>Run an external command passing it stdin and check for an error code</h2>
<br>
<p><a href="#3std">!<a class="notranslate" href="#4std-badge">std-badge</a></a> <a href="#3cat-os">!<a class="notranslate" href="#4cat-os-badge">cat-os-badge</a></a></p>
<br>
<p>Opens the <code>python</code> interpreter using an external <a class="notranslate" href="#4`Command`">`Command`</a> and passes it a
python statement for execution. <a class="notranslate" href="#4`Output`">`Output`</a> of statement is then parsed.</p>
<br>
<div data-lang="rust,no_run"><div data-l="# #[macro_use]"></div><div data-l="# extern crate error_chain;"></div><div data-l="#"></div><div data-l="use std::collections::HashSet;"></div><div data-l="use std::io::Write;"></div><div data-l="use std::process::{Command, Stdio};"></div><div data-l="#"></div><div data-l="# error_chain!{"></div><div data-l="#     errors { CmdError }"></div><div data-l="#     foreign_links {"></div><div data-l="#         Io(std::io::Error);"></div><div data-l="#         Utf8(std::string::FromUtf8Error);"></div><div data-l="#     }"></div><div data-l="# }"></div><div data-l=""></div><div data-l="fn run() -&gt; Result&lt;()&gt; {"></div><div data-l="    let mut child = Command::new(&quot;python&quot;).stdin(Stdio::piped())"></div><div data-l="        .stderr(Stdio::piped())"></div><div data-l="        .stdout(Stdio::piped())"></div><div data-l="        .spawn()?;"></div><div data-l=""></div><div data-l="    child.stdin"></div><div data-l="        .as_mut()"></div><div data-l="        .ok_or(&quot;Child process stdin has not been captured!&quot;)?"></div><div data-l="        .write_all(b&quot;import this; copyright(); credits(); exit()&quot;)?;"></div><div data-l=""></div><div data-l="    let output = child.wait_with_output()?;"></div><div data-l=""></div><div data-l="    if output.status.success() {"></div><div data-l="        let raw_output = String::from_utf8(output.stdout)?;"></div><div data-l="        let words = raw_output.split_whitespace()"></div><div data-l="            .map(|s| s.to_lowercase())"></div><div data-l="            .collect::&lt;HashSet&lt;_&gt;&gt;();"></div><div data-l="        println!(&quot;Found {} unique words:&quot;, words.len());"></div><div data-l="        println!(&quot;{:#?}&quot;, words);"></div><div data-l="        Ok(())"></div><div data-l="    } else {"></div><div data-l="        let err = String::from_utf8(output.stderr)?;"></div><div data-l="        bail!(&quot;External command failed:\n {}&quot;, err)"></div><div data-l="    }"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# quick_main!(run);"></div></div>
<br>
<a class="notranslate" href="#1https://doc.rust-lang.org/std/process/struct.Command.html">`Command`</a>
<a class="notranslate" href="#1https://doc.rust-lang.org/std/process/struct.Output.html">`Output`</a>