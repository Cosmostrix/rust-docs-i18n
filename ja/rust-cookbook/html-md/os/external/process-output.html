<!DOCTYPE html>
<h2>Run an external command and process stdout</h2>
<br>
<p><a href="#3regex">!<a class="notranslate" href="#4regex-badge">regex-badge</a></a> <a href="#3cat-os">!<a class="notranslate" href="#4cat-os-badge">cat-os-badge</a></a> <a href="#3cat-text-processing">!<a class="notranslate" href="#4cat-text-processing-badge">cat-text-processing-badge</a></a></p>
<br>
<p>Runs <code>git log --oneline</code> as an external <a class="notranslate" href="#4`Command`">`Command`</a> and inspects its <a class="notranslate" href="#4`Output`">`Output`</a>
using <a class="notranslate" href="#4`Regex`">`Regex`</a> to get the hash and message of the last 5 commits.</p>
<br>
<div data-lang="rust,no_run"><div data-l="# #[macro_use]"></div><div data-l="# extern crate error_chain;"></div><div data-l="extern crate regex;"></div><div data-l=""></div><div data-l="use std::process::Command;"></div><div data-l="use regex::Regex;"></div><div data-l="#"></div><div data-l="# error_chain!{"></div><div data-l="#     foreign_links {"></div><div data-l="#         Io(std::io::Error);"></div><div data-l="#         Regex(regex::Error);"></div><div data-l="#         Utf8(std::string::FromUtf8Error);"></div><div data-l="#     }"></div><div data-l="# }"></div><div data-l=""></div><div data-l="#[derive(PartialEq, Default, Clone, Debug)]"></div><div data-l="struct Commit {"></div><div data-l="    hash: String,"></div><div data-l="    message: String,"></div><div data-l="}"></div><div data-l=""></div><div data-l="fn run() -&gt; Result&lt;()&gt; {"></div><div data-l="    let output = Command::new(&quot;git&quot;).arg(&quot;log&quot;).arg(&quot;--oneline&quot;).output()?;"></div><div data-l=""></div><div data-l="    if !output.status.success() {"></div><div data-l="        bail!(&quot;Command executed with failing error code&quot;);"></div><div data-l="    }"></div><div data-l=""></div><div data-l="    let pattern = Regex::new(r&quot;(?x)"></div><div data-l="                               ([0-9a-fA-F]+) # commit hash"></div><div data-l="                               (.*)           # The commit message&quot;)?;"></div><div data-l=""></div><div data-l="    String::from_utf8(output.stdout)?"></div><div data-l="        .lines()"></div><div data-l="        .filter_map(|line| pattern.captures(line))"></div><div data-l="        .map(|cap| {"></div><div data-l="                 Commit {"></div><div data-l="                     hash: cap[1].to_string(),"></div><div data-l="                     message: cap[2].trim().to_string(),"></div><div data-l="                 }"></div><div data-l="             })"></div><div data-l="        .take(5)"></div><div data-l="        .for_each(|x| println!(&quot;{:?}&quot;, x));"></div><div data-l=""></div><div data-l="    Ok(())"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# quick_main!(run);"></div></div>
<br>
<a class="notranslate" href="#1https://doc.rust-lang.org/std/process/struct.Command.html">`Command`</a>
<a class="notranslate" href="#1https://doc.rust-lang.org/std/process/struct.Output.html">`Output`</a>
<a class="notranslate" href="#1https://docs.rs/regex/*/regex/struct.Regex.html">`Regex`</a>