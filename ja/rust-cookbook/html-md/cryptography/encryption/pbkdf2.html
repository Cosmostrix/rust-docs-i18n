<!DOCTYPE html>
<p><a name="ex-pbkdf2"></a>
## Salt and hash a password with PBKDF2</p>
<br>
<p><a href="#3ring">!<a class="notranslate" href="#4ring-badge">ring-badge</a></a> <a href="#3data-encoding">!<a class="notranslate" href="#4data-encoding-badge">data-encoding-badge</a></a> <a href="#3cat-cryptography">!<a class="notranslate" href="#4cat-cryptography-badge">cat-cryptography-badge</a></a></p>
<br>
<p>Uses <a class="notranslate" href="#4`ring::pbkdf2`">`ring::pbkdf2`</a> to hash a salted password using the PBKDF2 key derivation
function <a class="notranslate" href="#4`pbkdf2::derive`">`pbkdf2::derive`</a>.  Verifies the hash is correct with
<a class="notranslate" href="#4`pbkdf2::verify`">`pbkdf2::verify`</a>. The salt is generated using
<a class="notranslate" href="#4`SecureRandom::fill`">`SecureRandom::fill`</a>, which fills the salt byte array with
securely generated random numbers.</p>
<br>
<div data-lang="rust"><div data-l="# #[macro_use]"></div><div data-l="# extern crate error_chain;"></div><div data-l="extern crate data_encoding;"></div><div data-l="extern crate ring;"></div><div data-l="#"></div><div data-l="# error_chain! {"></div><div data-l="#   foreign_links {"></div><div data-l="#     Ring(ring::error::Unspecified);"></div><div data-l="#   }"></div><div data-l="# }"></div><div data-l=""></div><div data-l="use data_encoding::HEXUPPER;"></div><div data-l="use ring::{digest, pbkdf2, rand};"></div><div data-l="use ring::rand::SecureRandom;"></div><div data-l=""></div><div data-l="fn run() -&gt; Result&lt;()&gt; {"></div><div data-l="  const CREDENTIAL_LEN: usize = digest::SHA512_OUTPUT_LEN;"></div><div data-l="  const N_ITER: u32 = 100_000;"></div><div data-l="  let rng = rand::SystemRandom::new();"></div><div data-l=""></div><div data-l="  let mut salt = [0u8; CREDENTIAL_LEN];"></div><div data-l="  rng.fill(&amp;mut salt)?;"></div><div data-l=""></div><div data-l="  let password = &quot;Guess Me If You Can!&quot;;"></div><div data-l="  let mut pbkdf2_hash = [0u8; CREDENTIAL_LEN];"></div><div data-l="  pbkdf2::derive("></div><div data-l="      &amp;digest::SHA512,"></div><div data-l="      N_ITER,"></div><div data-l="      &amp;salt,"></div><div data-l="      password.as_bytes(),"></div><div data-l="      &amp;mut pbkdf2_hash,"></div><div data-l="  );"></div><div data-l="  println!(&quot;Salt: {}&quot;, HEXUPPER.encode(&amp;salt));"></div><div data-l="  println!(&quot;PBKDF2 hash: {}&quot;, HEXUPPER.encode(&amp;pbkdf2_hash));"></div><div data-l=""></div><div data-l="  let should_succeed = pbkdf2::verify("></div><div data-l="      &amp;digest::SHA512,"></div><div data-l="      N_ITER,"></div><div data-l="      &amp;salt,"></div><div data-l="      password.as_bytes(),"></div><div data-l="      &amp;pbkdf2_hash,"></div><div data-l="  );"></div><div data-l="  let wrong_password = &quot;Definitely not the correct password&quot;;"></div><div data-l="  let should_fail = pbkdf2::verify("></div><div data-l="      &amp;digest::SHA512,"></div><div data-l="      N_ITER,"></div><div data-l="      &amp;salt,"></div><div data-l="      wrong_password.as_bytes(),"></div><div data-l="      &amp;pbkdf2_hash,"></div><div data-l="  );"></div><div data-l=""></div><div data-l="  assert!(should_succeed.is_ok());"></div><div data-l="  assert!(!should_fail.is_ok());"></div><div data-l=""></div><div data-l="  Ok(())"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# quick_main!(run);"></div></div>
<br>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/pbkdf2/fn.derive.html">`pbkdf2::derive`</a>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/pbkdf2/fn.verify.html">`pbkdf2::verify`</a>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/pbkdf2/index.html">`ring::pbkdf2`</a>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/rand/trait.SecureRandom.html#tymethod.fill">`SecureRandom::fill`</a>