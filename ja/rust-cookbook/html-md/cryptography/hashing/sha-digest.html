<!DOCTYPE html>
<h2>Calculate the SHA-256 digest of a file</h2>
<br>
<p><a href="#3ring">!<a class="notranslate" href="#4ring-badge">ring-badge</a></a> <a href="#3data-encoding">!<a class="notranslate" href="#4data-encoding-badge">data-encoding-badge</a></a> <a href="#3cat-cryptography">!<a class="notranslate" href="#4cat-cryptography-badge">cat-cryptography-badge</a></a></p>
<br>
<p>Writes some data to a file, then calculates the SHA-256 <a class="notranslate" href="#4`digest::Digest`">`digest::Digest`</a> of
the file's contents using <a class="notranslate" href="#4`digest::Context`">`digest::Context`</a>.</p>
<br>
<div data-lang="rust"><div data-l="# #[macro_use]"></div><div data-l="# extern crate error_chain;"></div><div data-l="extern crate data_encoding;"></div><div data-l="extern crate ring;"></div><div data-l=""></div><div data-l="use data_encoding::HEXUPPER;"></div><div data-l="use ring::digest::{Context, Digest, SHA256};"></div><div data-l="use std::fs::File;"></div><div data-l="use std::io::{BufReader, Read, Write};"></div><div data-l="#"></div><div data-l="# error_chain! {"></div><div data-l="#     foreign_links {"></div><div data-l="#         Io(std::io::Error);"></div><div data-l="#         Decode(data_encoding::DecodeError);"></div><div data-l="#     }"></div><div data-l="# }"></div><div data-l=""></div><div data-l="fn sha256_digest&lt;R: Read&gt;(mut reader: R) -&gt; Result&lt;Digest&gt; {"></div><div data-l="    let mut context = Context::new(&amp;SHA256);"></div><div data-l="    let mut buffer = [0; 1024];"></div><div data-l=""></div><div data-l="    loop {"></div><div data-l="        let count = reader.read(&amp;mut buffer)?;"></div><div data-l="        if count == 0 {"></div><div data-l="            break;"></div><div data-l="        }"></div><div data-l="        context.update(&amp;buffer[..count]);"></div><div data-l="    }"></div><div data-l=""></div><div data-l="    Ok(context.finish())"></div><div data-l="}"></div><div data-l=""></div><div data-l="fn run() -&gt; Result&lt;()&gt; {"></div><div data-l="    let path = &quot;file.txt&quot;;"></div><div data-l=""></div><div data-l="    let mut output = File::create(path)?;"></div><div data-l="    write!(output, &quot;We will generate a digest of this text&quot;)?;"></div><div data-l=""></div><div data-l="    let input = File::open(path)?;"></div><div data-l="    let reader = BufReader::new(input);"></div><div data-l="    let digest = sha256_digest(reader)?;"></div><div data-l=""></div><div data-l="    println!(&quot;SHA-256 digest is {}&quot;, HEXUPPER.encode(digest.as_ref()));"></div><div data-l=""></div><div data-l="    Ok(())"></div><div data-l="}"></div><div data-l="#"></div><div data-l="# quick_main!(run);"></div></div>
<br>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/digest/struct.Context.html">`digest::Context`</a>
<a class="notranslate" href="#1https://briansmith.org/rustdoc/ring/digest/struct.Digest.html">`digest::Digest`</a>