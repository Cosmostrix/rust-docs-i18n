<!DOCTYPE html><html lang=ja-x-mtfrom-en><head><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(h){}};this.tick("start",null,a)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var f=0<d?new e(d):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();}).call(window);
</script><script src="https://translate.googleusercontent.com/translate/releases/twsfe_w_20180730_RC02/r/js/translate_c.js"></script><script>_intlStrings._originalText = "英語の原文テキスト:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="en|ja";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="%1$s に %2$s により翻訳されました";_intlStrings._unknown="不明";_intlStrings._suggestTranslation="翻訳を改善する"  ;_intlStrings._submit="送信";_intlStrings._suggestThanks="Google 翻訳の改善にご協力いただきありがとうございました。";_intlStrings._reverse=false;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href=capture.html hreflang=en rel="alternate machine-translated-from"><base href="" target=_top /></head><body><iframe src="https://translate.google.com/translate_un?hl=ja&prev=_t&sl=en&tl=ja&lang=en&usg=ALkJrhi1BDLmdbWiRXYMNxkaJ7TdmUrvmA" width=0 height=0 frameborder=0 style="width:0px;height:0px;border:0px;display:none;"></iframe><h1> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Capturing</span>キャプチャ</span> </h1><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Closures are inherently flexible and will do what the functionality requires to make the closure work without annotation.</span>クロージャは、本質的に柔軟性があり、アノテーションなしでクロージャを機能させるために機能が必要とすることを行います。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This allows capturing to flexibly adapt to the use case, sometimes moving and sometimes borrowing.</span>これにより、キャプチャをユースケースに柔軟に適応させることができます。時には移動したり、時には借りることもあります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Closures can capture variables:</span>クロージャは変数を取り込むことができます：</span> </p><br><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">by reference: <code>&amp;T</code></span>参考： <code>&amp;T</code></span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">by mutable reference: <code>&amp;mut T</code></span>可変参照： <code>&amp;mut T</code></span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">by value: <code>T</code></span>値による： <code>T</code></span> </div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">They preferentially capture variables by reference and only go lower when required.</span>彼らは優先的に参照によって変数を取り込み、必要なときだけ低くなる。</span> </p><br><div data-lang=rust,editable><div data-l="fn main() {"></div><div data-l="    use std::mem;"></div><div data-l="    "></div><div data-l="    let color = &quot;green&quot;;"></div><div data-l=""></div><div data-l="#    // A closure to print `color` which immediately borrows (`&amp;`)"></div><div data-l="#    // `color` and stores the borrow and closure in the `print`"></div><div data-l="#    // variable. It will remain borrowed until `print` goes out of"></div><div data-l="#    // scope. `println!` only requires `by reference` so it doesn't"></div><div data-l="#    // impose anything more restrictive."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A closure to print <code>color</code> which immediately borrows ( <code>&amp;</code> ) <code>color</code> and stores the borrow and closure in the <code>print</code> variable.</span>印刷する閉鎖<code>color</code>直ちに（借り<code>&amp;</code> ） <code>color</code>及び店舗で借りて閉鎖<code>print</code>変数。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It will remain borrowed until <code>print</code> goes out of scope.</span>それは<code>print</code>が範囲外になるまで借用されたままです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>println€</code> only requires <code>by reference</code> so it doesn&#39;t impose anything more restrictive.</span> <code>println€</code>は<code>by reference</code>のみ要求<code>by reference</code>ので、より制限的なものを課しません。</span> </div><div data-l="    let print = || println!(&quot;`color`: {}&quot;, color);"></div><div data-l=""></div><div data-l="#    // Call the closure using the borrow."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Call the closure using the borrow.</span>借り手を使ってクロージャを呼び出します。</span> </div><div data-l="    print();"></div><div data-l="    print();"></div><div data-l=""></div><div data-l="    let mut count = 0;"></div><div data-l=""></div><div data-l="#    // A closure to increment `count` could take either `&amp;mut count`"></div><div data-l="#    // or `count` but `&amp;mut count` is less restrictive so it takes"></div><div data-l="#    // that. Immediately borrows `count`."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A closure to increment <code>count</code> could take either <code>&amp;mut count</code> or <code>count</code> but <code>&amp;mut count</code> is less restrictive so it takes that.</span> <code>count</code>を増やすクロージャは<code>&amp;mut count</code>または<code>count</code>いずれかをとることができ<code>count</code>が、 <code>&amp;mut count</code>はそれほど制限がありません。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Immediately borrows <code>count</code> .</span>すぐに<code>count</code>借り<code>count</code> 。</span> </div><div data-l="    //"></div><div data-l="#    // A `mut` is required on `inc` because a `&amp;mut` is stored inside."></div><div data-l="#    // Thus, calling the closure mutates the closure which requires"></div><div data-l="#    // a `mut`."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A <code>mut</code> is required on <code>inc</code> because a <code>&amp;mut</code> is stored inside.</span> <code>&amp;mut</code>が内部に格納されているため、 <code>inc</code>は<code>mut</code>が必要です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Thus, calling the closure mutates the closure which requires a <code>mut</code> .</span>したがって、closureを呼び出すと、 <code>mut</code>を必要とするクロージャが変更されます。</span> </div><div data-l="    let mut inc = || {"></div><div data-l="        count += 1;"></div><div data-l="        println!(&quot;`count`: {}&quot;, count);"></div><div data-l="    };"></div><div data-l=""></div><div data-l="#    // Call the closure."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Call the closure.</span>クロージャを呼び出します。</span> </div><div data-l="    inc();"></div><div data-l="    inc();"></div><div data-l=""></div><div data-l="    //let _reborrow = &amp;mut count;"></div><div data-l="#    // ^ TODO: try uncommenting this line."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">^ TODO: try uncommenting this line.</span> ^ TODO：この行のコメントを外してみてください。</span> </div><div data-l="    "></div><div data-l="#    // A non-copy type."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A non-copy type.</span>非コピータイプ。</span> </div><div data-l="    let movable = Box::new(3);"></div><div data-l=""></div><div data-l="#    // `mem::drop` requires `T` so this must take by value. A copy type"></div><div data-l="#    // would copy into the closure leaving the original untouched."></div><div data-l="#    // A non-copy must move and so `movable` immediately moves into"></div><div data-l="#    // the closure."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>mem::drop</code> requires <code>T</code> so this must take by value.</span> <code>mem::drop</code>は<code>T</code>が必要なので、これは価値が必要です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A copy type would copy into the closure leaving the original untouched.</span>コピータイプはクロージャーにコピーし、元のままにします。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A non-copy must move and so <code>movable</code> immediately moves into the closure.</span>非コピーは移動しなければならず、移動<code>movable</code>のですぐにクロージャーに移動します。</span> </div><div data-l="    let consume = || {"></div><div data-l="        println!(&quot;`movable`: {:?}&quot;, movable);"></div><div data-l="        mem::drop(movable);"></div><div data-l="    };"></div><div data-l=""></div><div data-l="#    // `consume` consumes the variable so this can only be called once."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>consume</code> consumes the variable so this can only be called once.</span> <code>consume</code>は変数を<code>consume</code>するので、これは一度だけ呼び出すことができます。</span> </div><div data-l="    consume();"></div><div data-l="    //consume();"></div><div data-l="#    // ^ TODO: Try uncommenting this line."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">^ TODO: Try uncommenting this line.</span> ^ TODO：この行のコメントを外してみてください。</span> </div><div data-l=}></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Using <code>move</code> before vertical pipes forces closure to take ownership of captured variables:</span>垂直パイプの前に<code>move</code>を使用<code>move</code>クロージャはキャプチャされた変数の所有権を取得します。</span> </p><br><div data-lang=rust,editable><div data-l="fn main() {"></div><div data-l="#    // `Vec` has non-copy semantics."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>Vec</code> has non-copy semantics.</span> <code>Vec</code>は非コピーセマンティクスを持っています。</span> </div><div data-l="    let haystack = vec![1, 2, 3];"></div><div data-l=""></div><div data-l="    let contains = move |needle| haystack.contains(needle);"></div><div data-l=""></div><div data-l="    println!(&quot;{}&quot;, contains(&amp;1));"></div><div data-l="    println!(&quot;{}&quot;, contains(&amp;4));"></div><div data-l=""></div><div data-l="#    // `println!(&quot;There're {} elements in vec&quot;, haystack.len());`"></div><div data-l="#    // ^ Uncommenting above line will result in compile-time error"></div><div data-l="#    // because borrow checker doesn't allow re-using variable after it"></div><div data-l="#    // has been moved."></div><div data-l="    // "> <code>println€(&quot;There&#39;re {} elements in vec&quot;, haystack.len());</code> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">^ Uncommenting above line will result in compile-time error because borrow checker doesn&#39;t allow re-using variable after it has been moved.</span> ^上記の行をコメント解除すると、ボローチェッカーは移動後に再利用変数を許可しないため、コンパイル時にエラーが発生します。</span> </div><div data-l="    "></div><div data-l="#    // Removing `move` from closure's signature will cause closure"></div><div data-l="#    // to borrow _haystack_ variable immutably, hence _haystack_ is still"></div><div data-l="#    // available and uncommenting above line will not cause an error."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Removing <code>move</code> from closure&#39;s signature will cause closure to borrow <s>haystack</s> variable immutably, hence <s>haystack</s> is still available and uncommenting above line will not cause an error.</span>クロージャの署名からの<code>move</code>を削除<code>move</code> 、クロージャが<s>haystack</s>変数を不変に借りるため、 <s>haystack</s>は引き続き利用でき、上記のコメントを外してもエラーは発生しません。</span> </div><div data-l=}></div></div><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">See also:</span>参照：</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#3box><code>Box</code></a> and <a class=notranslate href=#3drop><code>std::mem::drop</code></a></span> <a class=notranslate href=#3box><code>Box</code></a>と<a class=notranslate href=#3drop><code>std::mem::drop</code></a></span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1std/box.html>box</a> <a class=notranslate href=#1https://doc.rust-lang.org/std/mem/fn.drop.html>drop</a></span> <a class=notranslate href=#1std/box.html>box</a> <a class=notranslate href=#1https://doc.rust-lang.org/std/mem/fn.drop.html>drop</a></span><script>_addload(function(){_setupIW('com');_csi('en','ja','capture.html');});</script>