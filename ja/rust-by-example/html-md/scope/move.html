<!DOCTYPE html>
<h1>Ownership and moves</h1>
<br>
<p>Because variables are in charge of freeing their own resources, 
<b>resources can only have one owner</b>. This also prevents resources 
from being freed more than once. Note that not all variables own 
resources (e.g. <a class="notranslate" href="#4references">references</a>).</p>
<br>
<p>When doing assignments (<code>let x = y</code>) or passing function arguments by value
(<code>foo(x)</code>), the <i>ownership</i> of the resources is transferred. In Rust-speak, 
this is known as a <i>move</i>.</p>
<br>
<p>After moving resources, the previous owner can no longer be used. This avoids
creating dangling pointers.</p>
<br>
<div data-lang="rust,editable"><div data-l="#// This function takes ownership of the heap allocated memory"></div><div data-l="// ">This function takes ownership of the heap allocated memory</div><div data-l="fn destroy_box(c: Box&lt;i32&gt;) {"></div><div data-l="    println!(&quot;Destroying a box that contains {}&quot;, c);"></div><div data-l=""></div><div data-l="#    // `c` is destroyed and the memory freed"></div><div data-l="    // "><code>c</code> is destroyed and the memory freed</div><div data-l="}"></div><div data-l=""></div><div data-l="fn main() {"></div><div data-l="#    // _Stack_ allocated integer"></div><div data-l="    // "><s>Stack</s> allocated integer</div><div data-l="    let x = 5u32;"></div><div data-l=""></div><div data-l="#    // *Copy* `x` into `y` - no resources are moved"></div><div data-l="    // "><i>Copy</i> <code>x</code> into <code>y</code> - no resources are moved</div><div data-l="    let y = x;"></div><div data-l=""></div><div data-l="#    // Both values can be independently used"></div><div data-l="    // ">Both values can be independently used</div><div data-l="    println!(&quot;x is {}, and y is {}&quot;, x, y);"></div><div data-l=""></div><div data-l="#    // `a` is a pointer to a _heap_ allocated integer"></div><div data-l="    // "><code>a</code> is a pointer to a <s>heap</s> allocated integer</div><div data-l="    let a = Box::new(5i32);"></div><div data-l=""></div><div data-l="    println!(&quot;a contains: {}&quot;, a);"></div><div data-l=""></div><div data-l="#    // *Move* `a` into `b`"></div><div data-l="    // "><i>Move</i> <code>a</code> into <code>b</code></div><div data-l="    let b = a;"></div><div data-l="#    // The pointer address of `a` is copied (not the data) into `b`."></div><div data-l="#    // Both are now pointers to the same heap allocated data, but"></div><div data-l="#    // `b` now owns it."></div><div data-l="    // ">The pointer address of <code>a</code> is copied (not the data) into <code>b</code>. Both are now pointers to the same heap allocated data, but <code>b</code> now owns it.</div><div data-l="    "></div><div data-l="#    // Error! `a` can no longer access the data, because it no longer owns the"></div><div data-l="#    // heap memory"></div><div data-l="    // ">Error! <code>a</code> can no longer access the data, because it no longer owns the heap memory</div><div data-l="    //println!(&quot;a contains: {}&quot;, a);"></div><div data-l="#    // TODO ^ Try uncommenting this line"></div><div data-l="    // ">TODO ^ Try uncommenting this line</div><div data-l=""></div><div data-l="#    // This function takes ownership of the heap allocated memory from `b`"></div><div data-l="    // ">This function takes ownership of the heap allocated memory from <code>b</code></div><div data-l="    destroy_box(b);"></div><div data-l=""></div><div data-l="#    // Since the heap memory has been freed at this point, this action would"></div><div data-l="#    // result in dereferencing freed memory, but it's forbidden by the compiler"></div><div data-l="#    // Error! Same reason as the previous Error"></div><div data-l="    // ">Since the heap memory has been freed at this point, this action would result in dereferencing freed memory, but it's forbidden by the compiler Error! Same reason as the previous Error</div><div data-l="    //println!(&quot;b contains: {}&quot;, b);"></div><div data-l="#    // TODO ^ Try uncommenting this line"></div><div data-l="    // ">TODO ^ Try uncommenting this line</div><div data-l="}"></div></div>
<br>
<a class="notranslate" href="#1flow_control/match/destructuring/destructure_pointers.html">references</a>