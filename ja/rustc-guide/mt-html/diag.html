<!DOCTYPE html><html lang=ja-x-mtfrom-en><head><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(h){}};this.tick("start",null,a)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var f=0<d?new e(d):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();}).call(window);
</script><script src="https://translate.googleusercontent.com/translate/releases/twsfe_w_20180723_RC00/r/js/translate_c.js"></script><script>_intlStrings._originalText = "英語の原文テキスト:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="en|ja";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="%1$s に %2$s により翻訳されました";_intlStrings._unknown="不明";_intlStrings._suggestTranslation="翻訳を改善する"  ;_intlStrings._submit="送信";_intlStrings._suggestThanks="Google 翻訳の改善にご協力いただきありがとうございました。";_intlStrings._reverse=false;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href=diag.html hreflang=en rel="alternate machine-translated-from"><base href="" target=_top /></head><body><iframe src="https://translate.google.com/translate_un?hl=ja&prev=_t&sl=en&tl=ja&lang=en&usg=ALkJrhi1BDLmdbWiRXYMNxkaJ7TdmUrvmA" width=0 height=0 frameborder=0 style="width:0px;height:0px;border:0px;display:none;"></iframe><h1> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Emitting Diagnostics</span>エミッション診断</span> </h1><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A lot of effort has been put into making <code>rustc</code> have great error messages.</span> <code>rustc</code>に大きなエラーメッセージが<code>rustc</code>ように多くの努力が払われています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This chapter is about how to emit compile errors and lints from the compiler.</span>この章では、コンパイラからコンパイルエラーとリントを発行する方法について説明します。</span> </p><br><h2> <code>Span</code> </h2> <br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#3span><code>Span</code></a> is the primary data structure in <code>rustc</code> used to represent a location in the code being compiled.</span> <a class=notranslate href=#3span><code>Span</code></a>は、コンパイル中のコード内の場所を表すために使用される<code>rustc</code>主要なデータ構造です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>Span</code> s are attached to most constructs in HIR and MIR, allowing for more informative error reporting.</span> <code>Span</code>は、HIRとMIRのほとんどのコンストラクトに添付されており、より有益なエラー報告が可能です。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.Span.html>span</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A <code>Span</code> can be looked up in a <a class=notranslate href=#3codemap><code>CodeMap</code></a> to get a &quot;snippet&quot; useful for displaying errors with <a class=notranslate href=#3sptosnip><code>span_to_snippet</code></a> and other similar methods on the <code>CodeMap</code> .</span> <code>Span</code>で調べることができ<a class=notranslate href=#3codemap><code>CodeMap</code></a>でエラーを表示するために有用な「スニペット」を取得し<a class=notranslate href=#3sptosnip><code>span_to_snippet</code></a>上や他の同様の方法<code>CodeMap</code> 。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html>codemap</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html#method.span_to_snippet>sptosnip</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html>codemap</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html#method.span_to_snippet>sptosnip</a></span> <br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Error messages</span>エラーメッセージ</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <a class=notranslate href=#3errors><code>rustc_errors</code></a> crate defines most of the utilities used for reporting errors.</span> <a class=notranslate href=#3errors><code>rustc_errors</code></a>枠は、エラーを報告するために使用されるほとんどのユーティリティを定義します。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/index.html>errors</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#3session><code>Session</code></a> and <a class=notranslate href=#3parsesses><code>ParseSess</code></a> have methods (or fields with methods) that allow reporting errors.</span> <a class=notranslate href=#3session><code>Session</code></a>と<a class=notranslate href=#3parsesses><code>ParseSess</code></a>は、エラーの報告を可能にするメソッド（またはメソッドを持つフィールド）があります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These methods usually have names like <code>span_err</code> or <code>struct_span_err</code> or <code>span_warn</code> , etc... There are lots of them;</span>これらのメソッドは、通常、 <code>struct_span_err</code>や<code>span_warn</code> 、 <code>span_err</code>などの名前を持っています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">they emit different types of &quot;errors&quot;, such as warnings, errors, fatal errors, suggestions, etc.</span>警告、エラー、致命的なエラー、提案などさまざまな種類の「エラー」を出します。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/parse/struct.ParseSess.html>parsesses</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html>session</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html>session</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/parse/struct.ParseSess.html>parsesses</a></span> <br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In general, there are two class of such methods: ones that emit an error directly and ones that allow finer control over what to emit.</span>一般に、このような方法には2つのクラスがあります。エラーを直接発生させる方法と、放出する内容をより細かく制御できる方法です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example, <a class=notranslate href=#3spanerr><code>span_err</code></a> emits the given error message at the given <code>Span</code> , but <a class=notranslate href=#3strspanerr><code>struct_span_err</code></a> instead returns a <a class=notranslate href=#3diagbuild><code>DiagnosticBuilder</code></a> .</span>例えば、 <a class=notranslate href=#3spanerr><code>span_err</code></a>所与で指定されたエラーメッセージを発する<code>Span</code>が、 <a class=notranslate href=#3strspanerr><code>struct_span_err</code></a>代わりに返し<a class=notranslate href=#3diagbuild><code>DiagnosticBuilder</code></a> 。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>DiagnosticBuilder</code> allows you to add related notes and suggestions to an error before emitting it by calling the <a class=notranslate href=#3emit><code>emit</code></a> method.</span> <code>DiagnosticBuilder</code>使用すると、 <a class=notranslate href=#3emit><code>emit</code></a>メソッドを呼び出して関連するメモと提案をエラーに追加することができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">(Failing to either emit or <a class=notranslate href=#3cancel>cancel</a> a <code>DiagnosticBuilder</code> will result in an ICE.) See the <a class=notranslate href=#3diagbuild>docs</a> for more info on what you can do.</span> （ <code>DiagnosticBuilder</code>発行または<a class=notranslate href=#3cancel>cancel</a>失敗すると、ICEが発生します）。できることの詳細については、 <a class=notranslate href=#3diagbuild>docs</a>を参照してください。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.span_err>spanerr</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.struct_span_err>strspanerr</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/diagnostic_builder/struct.DiagnosticBuilder.html>diagbuild</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/diagnostic_builder/struct.DiagnosticBuilder.html#method.emit>emit</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/struct.Diagnostic.html#method.cancel>cancel</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.span_err>spanerr</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.struct_span_err>strspanerr</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/diagnostic_builder/struct.DiagnosticBuilder.html>diagbuild</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/diagnostic_builder/struct.DiagnosticBuilder.html#method.emit>emit</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/struct.Diagnostic.html#method.cancel>cancel</a></span> <br><div data-lang=rust,ignore><div data-l="#// Get a DiagnosticBuilder. This does _not_ emit an error yet."></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Get a DiagnosticBuilder.</span> DiagnosticBuilderを取得します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This does <s>not</s> emit an error yet.</span>これはまだエラーを<s>出さ</s>ない。</span> </div><div data-l="let mut err = sess.struct_span_err(sp, &quot;oh no! this is an error!&quot;);"></div><div data-l=""></div><div data-l="#// In some cases, you might need to check if `sp` is generated by a macro to"></div><div data-l="#// avoid printing weird errors about macro-generated code."></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In some cases, you might need to check if <code>sp</code> is generated by a macro to avoid printing weird errors about macro-generated code.</span>場合によっては、マクロ生成コードに関する奇妙なエラーを避けるために、マクロによって<code>sp</code>が生成されているかどうかを確認する必要があります。</span> </div><div data-l=""></div><div data-l="if let Ok(snippet) = sess.codemap().span_to_snippet(sp) {"></div><div data-l="#    // Use the snippet to generate a suggested fix"></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Use the snippet to generate a suggested fix</span>スニペットを使用して推奨される修正を生成する</span> </div><div data-l="    err.span_suggestion(suggestion_sp, &quot;try using a qux here&quot;, format!(&quot;qux {}&quot;, snip));"></div><div data-l="} else {"></div><div data-l="#    // If we weren't able to generate a snippet, then emit a &quot;help&quot; message"></div><div data-l="#    // instead of a concrete &quot;suggestion&quot;. In practice this is unlikely to be"></div><div data-l="#    // reached."></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">If we weren&#39;t able to generate a snippet, then emit a &quot;help&quot; message instead of a concrete &quot;suggestion&quot;.</span>スニペットを生成できなかった場合は、具体的な「提案」の代わりに「ヘルプ」メッセージを表示します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In practice this is unlikely to be reached.</span>実際にはこれは達成されないでしょう。</span> </div><div data-l="    err.span_help(suggestion_sp, &quot;you could use a qux here instead&quot;);"></div><div data-l=}></div><div data-l=""></div><div data-l="#// emit the error"></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">emit the error</span>エラーを出す</span> </div><div data-l=err.emit();></div></div><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Suggestions</span>提案</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In addition to telling the user exactly <s>why</s> their code is wrong, it&#39;s oftentimes furthermore possible to tell them how to fix it.</span>ユーザにコードが間違っている<s>理由を</s>正確に伝えることに加えて、それを修正する方法を彼らに伝えることはしばしば可能です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">To this end, <code>DiagnosticBuilder</code> offers a structured suggestions API, which formats code suggestions pleasingly in the terminal, or (when the <code>--error-format json</code> flag is passed) as JSON for consumption by tools, most notably the <a href=#3rls>Rust Language Server</a> and <a class=notranslate href=#3rustfix><code>rustfix</code></a> .</span>この目的のために、 <code>DiagnosticBuilder</code>は、端末で気に入ったコード提案や、-- <code>--error-format json</code>フラグが渡されたときにJSONとしてツール（特に<a href=#3rls>Rust Language Server</a>と<a class=notranslate href=#3rustfix><code>rustfix</code></a> ）で使用するための構造化された提案APIを提供しています。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://github.com/rust-lang-nursery/rls>rls</a> <a class=notranslate href=#1https://github.com/rust-lang-nursery/rustfix>rustfix</a></span> <a class=notranslate href=#1https://github.com/rust-lang-nursery/rls>rls</a> <a class=notranslate href=#1https://github.com/rust-lang-nursery/rustfix>rustfix</a></span> <br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Not all suggestions should be applied mechanically.</span>すべての提案を機械的に適用する必要はありません。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Use the <a class=notranslate href=#3sswa><code>span_suggestion_with_applicability</code></a> method of <code>DiagnosticBuilder</code> to make a suggestion while providing a hint to tools whether the suggestion is mechanically applicable or not.</span> <code>DiagnosticBuilder</code>の<a class=notranslate href=#3sswa><code>span_suggestion_with_applicability</code></a>メソッドを使用して、提案が機械的に適用可能かどうかのヒントを提供しながら、提案を行います。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/struct.DiagnosticBuilder.html#method.span_suggestion_with_applicability>sswa</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example, to make our <code>qux</code> suggestion machine-applicable, we would do:</span>たとえば、 <code>qux</code>提案を適用するには、次のようにします。</span> </p><br><div data-lang=rust,ignore><div data-l="let mut err = sess.struct_span_err(sp, &quot;oh no! this is an error!&quot;);"></div><div data-l=""></div><div data-l="if let Ok(snippet) = sess.codemap().span_to_snippet(sp) {"></div><div data-l="#    // Add applicability info!"></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Add applicability info!</span>適用性情報を追加してください！</span> </div><div data-l="    err.span_suggestion_with_applicability("></div><div data-l="        suggestion_sp,"></div><div data-l="        &quot;try using a qux here&quot;,"></div><div data-l="        format!(&quot;qux {}&quot;, snip),"></div><div data-l="        Applicability::MachineApplicable,"></div><div data-l="    );"></div><div data-l="} else {"></div><div data-l="    err.span_help(suggestion_sp, &quot;you could use a qux here instead&quot;);"></div><div data-l=}></div><div data-l=""></div><div data-l=err.emit();></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This might emit an error like</span>これは次のようなエラーを出すかもしれません</span> </p><br><div data-lang=console><div data-l="$ rustc mycode.rs"></div><div data-l="error[E0999]: oh no! this is an error!"></div><div data-l=" --&gt; mycode.rs:3:5"></div><div data-l="  |"></div><div data-l="3 |     sad()"></div><div data-l="  |     ^ help: try using a qux here: `qux sad()`"></div><div data-l=""></div><div data-l="error: aborting due to previous error"></div><div data-l=""></div><div data-l="For more information about this error, try `rustc --explain E0999`."></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In some cases, like when the suggestion spans multiple lines or when there are multiple suggestions, the suggestions are displayed on their own:</span>場合によっては、提案が複数の行にまたがっている場合や複数の提案がある場合のように、提案は独自に表示されます：</span> </p><br><div data-lang=console><div data-l="error[E0999]: oh no! this is an error!"></div><div data-l=" --&gt; mycode.rs:3:5"></div><div data-l="  |"></div><div data-l="3 |     sad()"></div><div data-l="  |     ^"></div><div data-l="help: try using a qux here:"></div><div data-l="  |"></div><div data-l="3 |     qux sad()"></div><div data-l="  |     ^^^"></div><div data-l=""></div><div data-l="error: aborting due to previous error"></div><div data-l=""></div><div data-l="For more information about this error, try `rustc --explain E0999`."></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">There are a few other <a class=notranslate href=#3appl><code>Applicability</code></a> possibilities:</span>他にもいくつかの<a class=notranslate href=#3appl><code>Applicability</code></a>可能性があります。</span> </p><br><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>MachineApplicable</code> : Can be applied mechanically.</span> <code>MachineApplicable</code> ：機械的に適用することができます。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>HasPlaceholders</code> : Cannot be applied mechanically because it has placeholder text in the suggestions.</span> <code>HasPlaceholders</code> ：提案にプレースホルダテキストがあるため機械的には適用できません。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example, &quot;Try adding a type: \ <code>let x: \&lt;type\&gt;\</code> &quot;.</span>たとえば、「型を追加してみてください：\ <code>let x: \&lt;type\&gt;\</code> 」と入力します。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>MaybeIncorrect</code> : Cannot be applied mechanically because the suggestion may or may not be a good one.</span> <code>MaybeIncorrect</code> ：提案が良いものであるかもしれないし、そうでないかもしれないので機械的には適用できない。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>Unspecified</code> : Cannot be applied mechanically because we don&#39;t know which of the above cases it falls into.</span>未<code>Unspecified</code> ：上記のいずれのケースに該当するのかわからないため、機械的には適用できません。</span> </div><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_errors/enum.Applicability.html>appl</a> <br> <h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Lints</span>糸くず</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The compiler linting infrastructure is defined in the <a class=notranslate href=#3rlint><code>rustc::lint</code></a> module.</span>コンパイラリンキングインフラストラクチャは、 <a class=notranslate href=#3rlint><code>rustc::lint</code></a>モジュールで定義されています。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/lint/index.html>rlint</a> <br> <h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Declaring a lint</span>リント宣言</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The built-in compiler lints are defined in the <a class=notranslate href=#3builtin><code>rustc_lint</code></a> crate.</span>組み込みのコンパイラlintsは、 <a class=notranslate href=#3builtin><code>rustc_lint</code></a>クレートに定義されています。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_lint/index.html>builtin</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Each lint is defined as a <code>struct</code> that implements the <code>LintPass</code> <code>trait</code> .</span>各lintは、 <code>LintPass</code> <code>trait</code>を実装する<code>struct</code>として定義されてい<code>trait</code> 。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The trait implementation allows you to check certain syntactic constructs the linter walks the source code.</span> traitの実装では、リンターがソースコードを参照する特定の構文構造をチェックすることができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">You can then choose to emit lints in a very similar way to compile errors.</span>エラーをコンパイルするのと非常によく似た方法でlintを出力することができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Finally, you register the lint to actually get it to be run by the compiler by using the <code>declare_lint€</code> macro.</span>最後に、lintを登録して、 <code>declare_lint€</code>マクロを使用して<code>declare_lint€</code>コンパイラによって実行されるようにします。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example, the following lint checks for uses of <code>while true { ... }</code> and suggests using <code>loop { ... }</code> instead.</span>たとえば、次のlintは<code>while true { ... }</code>使用をチェックし、代わりに<code>loop { ... }</code>を使用することを提案し<code>loop { ... }</code> 。</span> </p><br><div data-lang=rust,ignore><div data-l="#// Declare a lint called `WHILE_TRUE`"></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Declare a lint called <code>WHILE_TRUE</code></span> <code>WHILE_TRUE</code>というリントを宣言する</span> </div><div data-l="declare_lint! {"></div><div data-l="    WHILE_TRUE,"></div><div data-l=""></div><div data-l="#    // warn-by-default"></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">warn-by-default</span>デフォルトで警告する</span> </div><div data-l="    Warn,"></div><div data-l=""></div><div data-l="#    // This string is the lint description"></div><div data-l="    // "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This string is the lint description</span>この文字列はリントの説明です</span> </div><div data-l="    &quot;suggest using `loop { }` instead of `while true { }`&quot;"></div><div data-l=}></div><div data-l=""></div><div data-l="#// Define a struct and `impl LintPass` for it."></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Define a struct and <code>impl LintPass</code> for it.</span>構造体と<code>impl LintPass</code>を定義します。</span> </div><div data-l="#[derive(Copy, Clone)]"></div><div data-l="pub struct WhileTrue;"></div><div data-l=""></div><div data-l="impl LintPass for WhileTrue {"></div><div data-l="    fn get_lints(&amp;self) -&gt; LintArray {"></div><div data-l="        lint_array!(WHILE_TRUE)"></div><div data-l="    }"></div><div data-l=}></div><div data-l=""></div><div data-l="#// LateLintPass has lots of methods. We only override the definition of"></div><div data-l="#// `check_expr` for this lint because that's all we need, but you could"></div><div data-l="#// override other methods for your own lint. See the rustc docs for a full"></div><div data-l="#// list of methods."></div><div data-l="// "> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">LateLintPass has lots of methods.</span> LateLintPassにはたくさんのメソッドがあります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">We only override the definition of <code>check_expr</code> for this lint because that&#39;s all we need, but you could override other methods for your own lint.</span>このlintの<code>check_expr</code>の定義をオーバーライドするだけですが、それだけで<code>check_expr</code>ですが、自分のlintのために他のメソッドをオーバーライドできます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">See the rustc docs for a full list of methods.</span>メソッドの完全なリストについては、rustcのドキュメントを参照してください。</span> </div><div data-l="impl&lt;'a, 'tcx&gt; LateLintPass&lt;'a, 'tcx&gt; for WhileTrue {"></div><div data-l="    fn check_expr(&amp;mut self, cx: &amp;LateContext, e: &amp;hir::Expr) {"></div><div data-l="        if let hir::ExprWhile(ref cond, ..) = e.node {"></div><div data-l="            if let hir::ExprLit(ref lit) = cond.node {"></div><div data-l="                if let ast::LitKind::Bool(true) = lit.node {"></div><div data-l="                    if lit.span.ctxt() == SyntaxContext::empty() {"></div><div data-l="                        let msg = &quot;denote infinite loops with `loop { ... }`&quot;;"></div><div data-l="                        let condition_span = cx.tcx.sess.codemap().def_span(e.span);"></div><div data-l="                        let mut err = cx.struct_span_lint(WHILE_TRUE, condition_span, msg);"></div><div data-l="                        err.span_suggestion_short(condition_span, &quot;use `loop`&quot;, &quot;loop&quot;.to_owned());"></div><div data-l="                        err.emit();"></div><div data-l="                    }"></div><div data-l="                }"></div><div data-l="            }"></div><div data-l="        }"></div><div data-l="    }"></div><div data-l=}></div></div><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Edition-gated Lints</span>版依存の糸くず</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Sometimes we want to change the behavior of a lint in a new edition.</span>時には新しい版で糸くずの動作を変えたいと思うことがあります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">To do this, we just add the transition to our invocation of <code>declare_lint€</code> :</span>これを行うには、 <code>declare_lint€</code>呼び出しにトランジションを追加するだけ<code>declare_lint€</code> ：</span> </p><br><div data-lang=rust,ignore><div data-l="declare_lint! {"></div><div data-l="    pub ANONYMOUS_PARAMETERS,"></div><div data-l="    Allow,"></div><div data-l="    &quot;detects anonymous parameters&quot;,"></div><div data-l="    Edition::Edition2018 =&gt; Warn,"></div><div data-l=}></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This makes the <code>ANONYMOUS_PARAMETERS</code> lint allow-by-default in the 2015 edition but warn-by-default in the 2018 edition.</span>これにより、 <code>ANONYMOUS_PARAMETERS</code> lintは2015年版でデフォルトで許可されますが、2018年版ではデフォルトで警告されます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Lints that represent an incompatibility (ie error) in the upcoming edition should also be registered as <code>FutureIncompatibilityLint</code> s in <a class=notranslate href=#3rbuiltins><code>register_builtins</code></a> function in <a class=notranslate href=#3builtin><code>rustc_lint::lib</code></a> .</span>次期版で互換性がない（すなわちエラー）を表すLintsもとして登録する必要があります<code>FutureIncompatibilityLint</code>での<a class=notranslate href=#3rbuiltins><code>register_builtins</code></a>中の関数<a class=notranslate href=#3builtin><code>rustc_lint::lib</code></a> 。</span> </p><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Lint Groups</span>リントグループ</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Lints can be turned on in groups.</span>リントはグループでオンにすることができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These groups are declared in the <a class=notranslate href=#3rbuiltins><code>register_builtins</code></a> function in <a class=notranslate href=#3builtin><code>rustc_lint::lib</code></a> .</span>これらのグループは、 <a class=notranslate href=#3builtin><code>rustc_lint::lib</code></a> <a class=notranslate href=#3rbuiltins><code>register_builtins</code></a>関数で宣言されてい<a class=notranslate href=#3rbuiltins><code>register_builtins</code></a> 。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>add_lint_group€</code> macro is used to declare a new group.</span> <code>add_lint_group€</code>マクロは、新しいグループを宣言するために使用されます。</span> </p><br> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_lint/fn.register_builtins.html>rbuiltins</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example,</span>例えば、</span> </p><br><div data-lang=rust,ignore><div data-l="    add_lint_group!(sess,"></div><div data-l="                    &quot;nonstandard_style&quot;,"></div><div data-l="                    NON_CAMEL_CASE_TYPES,"></div><div data-l="                    NON_SNAKE_CASE,"></div><div data-l="                    NON_UPPER_CASE_GLOBALS);"></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This defines the <code>nonstandard_style</code> group which turns on the listed lints.</span>これは、リストされたlintをオンにする<code>nonstandard_style</code>グループを定義します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A user can turn on these lints with a <code>€#[warn(nonstandard_style)]</code> attribute in the source code, or by passing <code>-W nonstandard-style</code> on the command line.</span>ユーザーは、ソースコードの<code>€#[warn(nonstandard_style)]</code>属性を使用するか、コマンドラインで<code>-W nonstandard-style</code>を渡して、これらのlintを有効にすることができます。</span> </p><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Linting early in the compiler</span>コンパイラの早い段階</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">On occasion, you may need to define a lint that runs before the linting system has been initialized (eg during parsing or macro expansion).</span>場合によっては、リンキングシステムが初期化される前に実行されるlintを定義する必要があるかもしれません（例えば、解析やマクロ展開中）。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is problematic because we need to have computed lint levels to know whether we should emit a warning or an error or nothing at all.</span>これは問題があります。なぜなら、警告またはエラーを出すべきかどうかを知るためには、lintレベルを計算する必要があるからです。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">To solve this problem, we buffer the lints until the linting system is processed.</span>この問題を解決するために、lintingシステムが処理されるまでlintをバッファします。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#3sessbl><code>Session</code></a> and <a class=notranslate href=#3parsebl><code>ParseSess</code></a> both have <code>buffer_lint</code> methods that allow you to buffer a lint for later.</span> <a class=notranslate href=#3sessbl><code>Session</code></a>と<a class=notranslate href=#3parsebl><code>ParseSess</code></a>両方に<code>buffer_lint</code>メソッドがあります。 <code>buffer_lint</code>メソッドを使うと、後でlintをバッファすることができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The linting system automatically takes care of handling buffered lints later.</span> lintingシステムは、後でバッファリングされたlintを自動的に処理します。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.buffer_lint>sessbl</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/parse/struct.ParseSess.html#method.buffer_lint>parsebl</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html#method.buffer_lint>sessbl</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/parse/struct.ParseSess.html#method.buffer_lint>parsebl</a></span> <br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Thus, to define a lint that runs early in the compilation, one defines a lint like normal but invokes the lint with <code>buffer_lint</code> .</span>したがって、コンパイルの初期段階で実行されるlintを定義するには、lintをnormalのように定義しますが、lintを<code>buffer_lint</code>呼び出します。</span> </p><br><h4> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Linting even earlier in the compiler</span>コンパイラの早い段階で糸曳き</span> </h4><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The parser ( <code>libsyntax</code> ) is interesting in that it cannot have dependencies on any of the other <code>librustc*</code> crates.</span>パーサー（ <code>libsyntax</code> ）は、他の<code>librustc*</code>クレートに依存することができない点で面白いです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In particular, it cannot depend on <code>librustc::lint</code> or <code>librustc_lint</code> , where all of the compiler linting infrastructure is defined.</span>特に、 <code>librustc::lint</code>や<code>librustc_lint</code>に依存することはできません<code>librustc::lint</code>や<code>librustc_lint</code>では、すべてのコンパイラlintingインフラストラクチャが定義されています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">That&#39;s troublesome!</span>それは面倒です！</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">To solve this, <code>libsyntax</code> defines its own buffered lint type, which <code>ParseSess::buffer_lint</code> uses.</span>これを解決するために、 <code>libsyntax</code>は独自のバッファリングされたlint型を定義します。これは<code>ParseSess::buffer_lint</code>使用します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">After macro expansion, these buffered lints are then dumped into the <code>Session::buffered_lints</code> used by the rest of the compiler.</span>マクロ展開の後、これらのバッファリングされたlintは、残りのコンパイラで使用される<code>Session::buffered_lints</code>ダンプされます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Usage for buffered lints in <code>libsyntax</code> is pretty much the same as the rest of the compiler with one exception because we cannot import the <code>LintId</code> s for lints we want to emit.</span>でバッファリングされlintsの使用上<code>libsyntax</code>私たちがインポートできないので、かなりの1つの例外を除き、コンパイラの他の部分と同じである<code>LintId</code>我々が発光するようにしたいlintsため秒。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Instead, the <a class=notranslate href="#4`BufferedEarlyLintId`">`BufferedEarlyLintId`</a> type is used.</span>代わりに、 <a class=notranslate href="#4`BufferedEarlyLintId`">`BufferedEarlyLintId`</a>型が使用されます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">If you are defining a new lint, you will want to add an entry to this enum.</span>新しいlintを定義している場合は、この列挙型に項目を追加することになります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Then, add an appropriate mapping to the body of <a class=notranslate href=#3fplid><code>Lint::from_parser_lint_id</code></a> .</span>次に、 <a class=notranslate href=#3fplid><code>Lint::from_parser_lint_id</code></a>本文に適切なマッピングを追加します。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/early_buffered_lints/struct.BufferedEarlyLintId.html>`BufferedEarlyLintId`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/lint/struct.Lint.html#from_parser_lint_id>fplid</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/early_buffered_lints/struct.BufferedEarlyLintId.html>`BufferedEarlyLintId`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/lint/struct.Lint.html#from_parser_lint_id>fplid</a></span><script>_addload(function(){_setupIW('com');_csi('en','ja','diag.html');});</script>