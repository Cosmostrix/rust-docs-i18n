<!DOCTYPE html><html lang=ja-x-mtfrom-en><head><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(h){}};this.tick("start",null,a)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var f=0<d?new e(d):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();}).call(window);
</script><script src="https://translate.googleusercontent.com/translate/releases/twsfe_w_20180723_RC00/r/js/translate_c.js"></script><script>_intlStrings._originalText = "英語の原文テキスト:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="en|ja";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="%1$s に %2$s により翻訳されました";_intlStrings._unknown="不明";_intlStrings._suggestTranslation="翻訳を改善する"  ;_intlStrings._submit="送信";_intlStrings._suggestThanks="Google 翻訳の改善にご協力いただきありがとうございました。";_intlStrings._reverse=false;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href=rustdoc.html hreflang=en rel="alternate machine-translated-from"><base href="" target=_top /></head><body><iframe src="https://translate.google.com/translate_un?hl=ja&prev=_t&sl=en&tl=ja&lang=en&usg=ALkJrhi1BDLmdbWiRXYMNxkaJ7TdmUrvmA" width=0 height=0 frameborder=0 style="width:0px;height:0px;border:0px;display:none;"></iframe><h1> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The walking tour of rustdoc</span> rustdocのウォーキングツアー</span> </h1><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Rustdoc actually uses the rustc internals directly.</span> Rustdocは実際にはrustcの内部構造を直接使用しています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It lives in-tree with the compiler and standard library.</span>コンパイラと標準ライブラリでツリー内に存在します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This chapter is about how it works.</span>この章では、どのように動作するかについて説明します。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Rustdoc is implemented entirely within the crate <a class=notranslate href=#3rd><code>librustdoc</code></a> .</span> Rustdocはクレート内に完全に実装されて<a class=notranslate href=#3rd><code>librustdoc</code></a> 。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It runs the compiler up to the point where we have an internal representation of a crate (HIR) and the ability to run some queries about the types of items.</span>これはコンパイラを実行して、クレート（HIR）の内部表現を持ち、アイテムのタイプについていくつかのクエリを実行できるようになります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#4HIR>HIR</a> and <a class=notranslate href=#4queries>queries</a> are discussed in the linked chapters.</span> <a class=notranslate href=#4HIR>HIR</a>と<a class=notranslate href=#4queries>queries</a>については、リンクされた章で説明します。</span> </p><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1./hir.html>HIR</a> <a class=notranslate href=#1./query.html>queries</a> <a class=notranslate href=#1https://github.com/rust-lang/rust/tree/master/src/librustdoc>rd</a></span> <a class=notranslate href=#1./hir.html>HIR</a> <a class=notranslate href=#1./query.html>queries</a> <a class=notranslate href=#1https://github.com/rust-lang/rust/tree/master/src/librustdoc>rd</a></span> <br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>librustdoc</code> performs two major steps after that to render a set of documentation:</span> <code>librustdoc</code>は、それ以降の2つの主要なステップを実行して一連のドキュメントをレンダリングします。</span> </p><br><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">&quot;Clean&quot; the AST into a form that&#39;s more suited to creating documentation (and slightly more resistant to churn in the compiler).</span> ASTをドキュメントを作成するのに適した形にしています（そして、コンパイラの解読に若干抵抗力があります）。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Use this cleaned AST to render a crate&#39;s documentation, one page at a time.</span>一度に1ページずつクレートのドキュメントをレンダリングするには、このクリーンASTを使用します。</span> </div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Naturally, there&#39;s more than just this, and those descriptions simplify out lots of details, but that&#39;s the high-level overview.</span>当然ながら、これ以上のものがあり、それらの記述は詳細を多く簡略化しますが、それは高水準の概要です。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">(Side note: <code>librustdoc</code> is a library crate! The <code>rustdoc</code> binary is created using the project in <a class=notranslate href=#3bin><code>src/tools/rustdoc</code></a> . Note that literally all that does is call the <code>main()</code> that&#39;s in this crate&#39;s <code>lib.rs</code> , though.)</span> （サイドノート： <code>librustdoc</code>はライブラリの箱です！） <code>rustdoc</code>バイナリは<a class=notranslate href=#3bin><code>src/tools/rustdoc</code></a>プロジェクトを使って作成されていますが、文字通り、このクレートの<code>lib.rs</code>にある<code>main()</code>を呼び出しています。</span> </p><br> <a class=notranslate href=#1https://github.com/rust-lang/rust/tree/master/src/tools/rustdoc>bin</a> <br> <h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Cheat sheet</span>カンニングペーパー</span> </h2><br><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Use <code>./x.py build --stage 1 src/libstd src/tools/rustdoc</code> to make a useable rustdoc you can run on other projects.</span> <code>./x.py build --stage 1 src/libstd src/tools/rustdoc</code>を使用して、他のプロジェクトで実行可能なrustdocを作成してください。</span> </div><div data-b="  *"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Add <code>src/libtest</code> to be able to use <code>rustdoc --test</code> .</span> <code>rustdoc --test</code>を使用できるように<code>src/libtest</code>を追加してください。</span> </div><div data-b="  *"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">If you&#39;ve used <code>rustup toolchain link local /path/to/build/$TARGET/stage1</code> previously, then after the previous build command, <code>cargo +local doc</code> will Just Work.</span>前回のビルドコマンドの後に<code>rustup toolchain link local /path/to/build/$TARGET/stage1</code>を使用した場合、 <code>cargo +local doc</code>はJust Workとなります。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Use <code>./x.py doc --stage 1 src/libstd</code> to use this rustdoc to generate the standard library docs.</span> <code>./x.py doc --stage 1 src/libstd</code>を使用して、このrustdocを使用して標準ライブラリdocsを生成します。</span> </div><div data-b="  *"> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The completed docs will be available in <code>build/$TARGET/doc/std</code> , though the bundle is meant to be used as though you would copy out the <code>doc</code> folder to a web server, since that&#39;s where the CSS/JS and landing page are.</span>完成したドキュメントは<code>build/$TARGET/doc/std</code>で利用できますが、バンドルはCSS / JSとリンク先ページがあるため、 <code>doc</code>フォルダをWebサーバーにコピーするように使用されます。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Most of the HTML printing code is in <code>html/format.rs</code> and <code>html/render.rs</code> .</span>ほとんどのHTML印刷コードは<code>html/format.rs</code>と<code>html/render.rs</code>ます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It&#39;s in a bunch of <code>fmt::Display</code> implementations and supplementary functions.</span>これは<code>fmt::Display</code>実装と補足関数の束です。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The types that got <code>Display</code> impls above are defined in <code>clean/mod.rs</code> , right next to the custom <code>Clean</code> trait used to process them out of the rustc HIR.</span>上記の<code>Display</code>インプラントを持つタイプは、 <code>clean/mod.rs</code>で定義されています。カスタムHIRからそれらを処理するために使用されるカスタム<code>Clean</code>特性のすぐ隣にあります。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The bits specific to using rustdoc as a test harness are in <code>test.rs</code> .</span>テストハーネスとしてのrustdocの使用に固有のビットは<code>test.rs</code>ます。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The Markdown renderer is loaded up in <code>html/markdown.rs</code> , including functions for extracting doctests from a given block of Markdown.</span> Markdownレンダラーは<code>html/markdown.rs</code>ロードされ、Markdownの与えられたブロックからdoctestを抽出する関数を含みます。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The tests on rustdoc <i>output</i> are located in <code>src/test/rustdoc</code> , where they&#39;re handled by the test runner of rustbuild and the supplementary script <code>src/etc/htmldocck.py</code> .</span> rustdoc <i>出力</i>のテストは<code>src/test/rustdoc</code>にあります。そこではrustbuildのテストランナーと補足スクリプト<code>src/etc/htmldocck.py</code>ます。</span> </div><div data-b=*> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Tests on search index generation are located in <code>src/test/rustdoc-js</code> , as a series of JavaScript files that encode queries on the standard library search index and expected results.</span>検索インデックスの生成に関するテストは、 <code>src/test/rustdoc-js</code>にあります。これは、標準ライブラリ検索インデックスと期待される結果に関するクエリをエンコードする一連のJavaScriptファイルです。</span> </div><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">From crate to clean</span>クレートからクリーンまで</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In <code>core.rs</code> are two central items: the <code>DocContext</code> struct, and the <code>run_core</code> function.</span> <code>core.rs</code>は、 <code>DocContext</code>構造体と<code>run_core</code>関数の2つの中心的な項目が<code>run_core</code>ます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The latter is where rustdoc calls out to rustc to compile a crate to the point where rustdoc can take over.</span>後者は、rustdocが引き継ぐことができるポイントまで木箱をコンパイルするためにrustdocがrustcに呼び出すところです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The former is a state container used when crawling through a crate to gather its documentation.</span>前者は、ドキュメントを収集するためにクレートを通ってクロールするときに使用される状態コンテナです。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The main process of crate crawling is done in <code>clean/mod.rs</code> through several implementations of the <code>Clean</code> trait defined within.</span>クレートクロールのメインプロセスは、 <code>clean/mod.rs</code>定義された<code>Clean</code>な特性のいくつかの実装を通じて行われます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is a conversion trait, which defines one method:</span>これは1つの方法を定義する変換特性です。</span> </p><br><div data-lang=rust,ignore><div data-l="pub trait Clean&lt;T&gt; {"></div><div data-l="    fn clean(&amp;self, cx: &amp;DocContext) -&gt; T;"></div><div data-l=}></div></div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>clean/mod.rs</code> also defines the types for the &quot;cleaned&quot; AST used later on to render documentation pages.</span> <code>clean/mod.rs</code>は、ドキュメントページをレンダリングするために後で使用される「クリーン」ASTのタイプも定義します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Each usually accompanies an implementation of <code>Clean</code> that takes some AST or HIR type from rustc and converts it into the appropriate &quot;cleaned&quot; type.</span>それぞれは、通常、rustcのASTまたはHIRタイプを取り、適切な「クリーン」タイプに変換する<code>Clean</code>実装に伴います。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">&quot;Big&quot; items like modules or associated items may have some extra processing in its <code>Clean</code> implementation, but for the most part these impls are straightforward conversions.</span>モジュールや関連アイテムのような「ビッグ」アイテムは、 <code>Clean</code>実装では余分な処理を行うことがありますが、ほとんどの場合、これらのインプットは直接的な変換です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The &quot;entry point&quot; to this module is the <code>impl Clean&lt;Crate&gt; for visit_ast::RustdocVisitor</code> , which is called by <code>run_core</code> above.</span>このモジュールの「エントリーポイント」は、上記の<code>run_core</code>によって<code>run_core</code>れる<code>impl Clean&lt;Crate&gt; for visit_ast::RustdocVisitor</code>の<code>impl Clean&lt;Crate&gt; for visit_ast::RustdocVisitor</code> 。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">You see, I actually lied a little earlier: There&#39;s another AST transformation that happens before the events in <code>clean/mod.rs</code> .</span>あなたは、少し前に私は実際に嘘をつきました： <code>clean/mod.rs</code>イベントの前に起こる別のAST変換があります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In <code>visit_ast.rs</code> is the type <code>RustdocVisitor</code> , which <i>actually</i> crawls a <code>hir::Crate</code> to get the first intermediate representation, defined in <code>doctree.rs</code> .</span> <code>visit_ast.rs</code>はタイプ<code>RustdocVisitor</code>があります。 <i>実際に</i>は<code>hir::Crate</code>をクロールして、最初の中間表現を取得し<code>doctree.rs</code> 。これは<code>doctree.rs</code>で定義されてい<code>doctree.rs</code> 。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This pass is mainly to get a few intermediate wrappers around the HIR types and to process visibility and inlining.</span>このパスは、主に、HIRタイプの周りにいくつかの中間ラッパーを取得し、可視性とインライン化を処理することです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is where <code>#[doc(inline)]</code> , <code>#[doc(no_inline)]</code> , and <code>#[doc(hidden)]</code> are processed, as well as the logic for whether a <code>pub use</code> should get the full page or a &quot;Reexport&quot; line in the module page.</span>これは、 <code>#[doc(inline)]</code> 、 <code>#[doc(no_inline)]</code> 、 <code>#[doc(hidden)]</code>が処理され、 <code>pub use</code>フルページを取得するか、モジュールページの行。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The other major thing that happens in <code>clean/mod.rs</code> is the collection of doc comments and <code>#[doc=&quot;&quot;]</code> attributes into a separate field of the Attributes struct, present on anything that gets hand-written documentation.</span> <code>clean/mod.rs</code>で起こるもう一つの主要なことは、 <code>clean/mod.rs</code>のドキュメントを取得するものの上にある、Attributes構造体の別のフィールドにドキュメントコメントと<code>#[doc=&quot;&quot;]</code>属性のコレクションです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This makes it easier to collect this documentation later in the process.</span>これにより、プロセスの後半でこの文書を簡単に収集することができます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The primary output of this process is a <code>clean::Crate</code> with a tree of Items which describe the publicly-documentable items in the target crate.</span>このプロセスの主な出力は、 <code>clean::Crate</code>で、アイテムのツリーがあり、ターゲットのクレートに公開されているドキュメント化可能なアイテムを記述します。</span> </p><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Hot potato</span>焼き芋</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Before moving on to the next major step, a few important &quot;passes&quot; occur over the documentation.</span>次の大きなステップに進む前に、ドキュメントにいくつかの重要な「パス」が発生します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These do things like combine the separate &quot;attributes&quot; into a single string and strip leading whitespace to make the document easier on the markdown parser, or drop items that are not public or deliberately hidden with <code>#[doc(hidden)]</code> .</span>これらは、別々の &quot;属性&quot;を1つの文字列に組み込み、先頭の空白を取り除いてマークダウンパーサ上でドキュメントを簡単にしたり、 <code>#[doc(hidden)]</code>公開または故意に隠されていないアイテムをドロップしたりするような処理を行います。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These are all implemented in the <code>passes/</code> directory, one file per pass.</span>これらはすべて<code>passes/</code>ディレクトリに実装されています。パスごとに1つのファイルです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">By default, all of these passes are run on a crate, but the ones regarding dropping private/hidden items can be bypassed by passing <code>--document-private-items</code> to rustdoc.</span>デフォルトでは、これらのパスはすべてクレートで実行されますが、private / hidden項目の削除に関する<code>--document-private-items</code>をrustdocに渡すことで回避できます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Note that unlike the previous set of AST transformations, the passes happen on the <s>cleaned</s> crate.</span>以前のAST変換のセットとは異なり、パスは<s>クリーン・</s>クレートで<s>行われる</s>ことに注意してください。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">(Strictly speaking, you can fine-tune the passes run and even add your own, but <a href=#344136>we&#39;re trying to deprecate that</a> . If you need finer-grain control over these passes, please let us know!)</span> （厳密に微調整パスが実行しても、あなた自身を追加し、あなたが言えば、しかし、 <a href=#344136>我々はそれを廃止しようとしている</a> 。あなたはこれらのパスを細かく粒に制御する必要がある場合は、私たちに知らせてください！）</span> </p><br> <a class=notranslate href=#1https://github.com/rust-lang/rust/issues/44136>44136</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Here is current (as of this writing) list of passes:</span>ここに現在の（この執筆時点で）パスのリストがあります：</span> </p><br><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>propagate-doc-cfg</code> - propagates <code>#[doc(cfg(...))]</code> to child items.</span> <code>propagate-doc-cfg</code> - <code>#[doc(cfg(...))]</code>を子項目に伝播します。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>collapse-docs</code> concatenates all document attributes into one document attribute.</span> <code>collapse-docs</code>すべてのドキュメント属性を1つのドキュメント属性に連結します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is necessary because each line of a doc comment is given as a separate doc attribute, and this will combine them into a single string with line breaks between each attribute.</span>これは、docコメントの各行が別々のdoc属性として指定され、各属性間に改行を含む単一の文字列に結合されるため必要です。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>unindent-comments</code> removes excess indentation on comments in order for markdown to like it.</span> <code>unindent-comments</code>は、マークダウンが好きになるように、コメントの余分な字下げを取り除きます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is necessary because the convention for writing documentation is to provide a space between the <code>///</code> or <code>//€</code> marker and the text, and stripping that leading space will make the text easier to parse by the Markdown parser.</span>これは、ドキュメントを書くための規約は、 <code>///</code>または<code>//€</code>マーカーとテキストの間にスペースを入れ、その先頭のスペースを取り除くことで、Markdownパーサーがテキストを解析しやすくするためです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">(In the past, the markdown parser used was not Commonmark- compliant, which caused annoyances with extra whitespace but this seems to be less of an issue today.)</span> （以前は、使用されたマークダウンパーサーはCommonmarkに準拠していなかったため、余分な空白を迷惑にしていましたが、今日はそれほど問題にはならないようです）。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>strip-priv-imports</code> strips all private import statements ( <code>use</code> , <code>extern crate</code> ) from a crate.</span> <code>strip-priv-imports</code>は、クレートからすべてのプライベートインポートステートメント（ <code>use</code> 、 <code>extern crate</code> ）を削除します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is necessary because rustdoc will handle <i>public</i> imports by either inlining the item&#39;s documentation to the module or creating a &quot;Reexports&quot; section with the import in it.</span>これは、rustdocがアイテムのドキュメンテーションをモジュールにインライン展開するか、インポートした「Reexports」セクションを作成することで、 <i>パブリック</i>インポートを処理するために必要です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The pass ensures that all of these imports are actually relevant to documentation.</span>パスは、これらの輸入のすべてが実際に文書に関連していることを保証します。</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>strip-hidden</code> and <code>strip-private</code> strip all <code>doc(hidden)</code> and private items from the output.</span> <code>strip-hidden</code>と<code>strip-private</code>すべての<code>doc(hidden)</code>とプライベート項目を出力から削除します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><code>strip-private</code> implies <code>strip-priv-imports</code> .</span> <code>strip-private</code> 、 <code>strip-priv-imports</code>意味<code>strip-priv-imports</code>ます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Basically, the goal is to remove items that are not relevant for public documentation.</span>基本的には、公開ドキュメントに関係のないアイテムを削除することが目標です。</span> </div><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">From clean to crate</span>クリーンからクレートまで</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is where the &quot;second phase&quot; in rustdoc begins.</span>これは、rustdocの「第2段階」が始まるところです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This phase primarily lives in the <code>html/</code> folder, and it all starts with <code>run()</code> in <code>html/render.rs</code> .</span>このフェーズは主に<code>html/</code>フォルダにあり、 <code>html/render.rs</code>では<code>run()</code>で<code>html/render.rs</code>ます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This code is responsible for setting up the <code>Context</code> , <code>SharedContext</code> , and <code>Cache</code> which are used during rendering, copying out the static files which live in every rendered set of documentation (things like the fonts, CSS, and JavaScript that live in <code>html/static/</code> ), creating the search index, and printing out the source code rendering, before beginning the process of rendering all the documentation for the crate.</span>このコードは、レンダリング時に使用される<code>Context</code> 、 <code>SharedContext</code> 、および<code>Cache</code>を設定し、レンダリングされたすべてのドキュメントセット（ <code>html/static/</code>するフォント、CSS、JavaScriptなど）に存在する静的ファイルをコピーします。 ）、検索インデックスを作成し、ソースコードレンダリングを印刷してから、クレートのすべてのドキュメントをレンダリングするプロセスを開始します。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Several functions implemented directly on <code>Context</code> take the <code>clean::Crate</code> and set up some state between rendering items or recursing on a module&#39;s child items.</span> <code>Context</code>直接実装されたいくつかの関数は、 <code>clean::Crate</code>を取り、レンダリング項目間またはモジュールの子項目で再帰する間にある状態を設定します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">From here the &quot;page rendering&quot; begins, via an enormous <code>write€()</code> call in <code>html/layout.rs</code> .</span>ここからは、 <code>html/layout.rs</code>巨大な<code>write€()</code>呼び出しを介して、 &quot;ページレンダリング&quot;が始まります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The parts that actually generate HTML from the items and documentation occurs within a series of <code>std::fmt::Display</code> implementations and functions that pass around a <code>&amp;mut std::fmt::Formatter</code> .</span>アイテムとドキュメントから実際にHTMLを生成する部分は、一連の<code>std::fmt::Display</code>実装と、 <code>&amp;mut std::fmt::Formatter</code>を渡す関数内で発生します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The top-level implementation that writes out the page body is the <code>impl&lt;&#39;a&gt; fmt::Display for Item&lt;&#39;a&gt;</code> in <code>html/render.rs</code> , which switches out to one of several <code>item_*</code> functions based on the kind of <code>Item</code> being rendered.</span>ページ本文を書き出すトップレベルの実装は、 <code>html/render.rs</code> <code>impl&lt;&#39;a&gt; fmt::Display for Item&lt;&#39;a&gt;</code>の<code>impl&lt;&#39;a&gt; fmt::Display for Item&lt;&#39;a&gt;</code>であり、その種類に基づいていくつかの<code>item_*</code>関数の1つに切り替わりますレンダリングされる<code>Item</code> 。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Depending on what kind of rendering code you&#39;re looking for, you&#39;ll probably find it either in <code>html/render.rs</code> for major items like &quot;what sections should I print for a struct page&quot; or <code>html/format.rs</code> for smaller component pieces like &quot;how should I print a where clause as part of some other item&quot;.</span>あなたが探しているレンダリングコードの種類に応じて、おそらく、 <code>html/render.rs</code> 、 &quot;構造ページのためにどのセクションを印刷すべきか&quot;、または小さなコンポーネントのための<code>html/format.rs</code> 「where句を他のアイテムの一部としてどのように出力すればよいか」のようなものです。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Whenever rustdoc comes across an item that should print hand-written documentation alongside, it calls out to <code>html/markdown.rs</code> which interfaces with the Markdown parser.</span> rustdocが手書きのドキュメントを横に並べて表示するアイテムを見つけるたびに、Markdownパーサとインターフェイスする<code>html/markdown.rs</code>を呼び出します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This is exposed as a series of types that wrap a string of Markdown, and implement <code>fmt::Display</code> to emit HTML text.</span>これはMarkdownの文字列をラップする一連の型として公開され、 <code>fmt::Display</code>を実装してHTMLテキストを出力します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It takes special care to enable certain features like footnotes and tables and add syntax highlighting to Rust code blocks (via <code>html/highlight.rs</code> ) before running the Markdown parser.</span>脚注や表のような特定の機能を有効にし、Markdownパーサーを実行する前に錆コードブロック（ <code>html/highlight.rs</code>経由）に構文ハイライトを追加することには特別な注意が必要です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">There&#39;s also a function in here ( <code>find_testable_code</code> ) that specifically scans for Rust code blocks so the test-runner code can find all the doctests in the crate.</span>テストランナーコードがクレート内のすべてのdoctestを見つけることができるように、錆コードブロックをスキャンする関数（ <code>find_testable_code</code> ）もあります。</span> </p><br><h3> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">From soup to nuts</span>スープからナッツまで</span> </h3><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">(alternate title: <a href=#3video>&quot;An unbroken thread that stretches from those first <code>Cell</code> s to us&quot;</a> )</span> （代替タイトル： <a href=#3video>「最初の<code>Cell</code>から私たちに伸びる破られていないスレッド」</a> ）</span> </p><br> <a class=notranslate href=#1https://www.youtube.com/watch?v=hOLAGYmUQV0>video</a> <br> <p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It&#39;s important to note that the AST cleaning can ask the compiler for information (crucially, <code>DocContext</code> contains a <code>TyCtxt</code> ), but page rendering cannot.</span>これは、ASTのクリーニングが（決定的に、情報のためのコンパイラを頼むことができることに注意することが重要です<code>DocContext</code>含まれている<code>TyCtxt</code> ）が、ページのレンダリングができません。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>clean::Crate</code> created within <code>run_core</code> is passed outside the compiler context before being handed to <code>html::render::run</code> .</span> <code>run_core</code>で作成された<code>clean::Crate</code>は、 <code>html::render::run</code>に渡される前にコンパイラコンテキストの外側に渡され<code>html::render::run</code> 。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This means that a lot of the &quot;supplementary data&quot; that isn&#39;t immediately available inside an item&#39;s definition, like which trait is the <code>Deref</code> trait used by the language, needs to be collected during cleaning, stored in the <code>DocContext</code> , and passed along to the <code>SharedContext</code> during HTML rendering.</span>これは、言語によって使用される<code>Deref</code>特性であるアイテムの定義内ですぐに利用できない「補足データ」の多くが、クリーニング中に収集され、 <code>DocContext</code>に格納され、 HTMLレンダリング中の<code>SharedContext</code></span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This manifests as a bunch of shared state, context variables, and <code>RefCell</code> s.</span>これは共有状態、コンテキスト変数、および<code>RefCell</code>の束として現れます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Also of note is that some items that come from &quot;asking the compiler&quot; don&#39;t go directly into the <code>DocContext</code> - for example, when loading items from a foreign crate, rustdoc will ask about trait implementations and generate new <code>Item</code> s for the impls based on that information.</span>また、 &quot;コンパイラに質問する&quot; <code>DocContext</code>由来するいくつかの項目は、 <code>DocContext</code>に直接は行きません。例えば、外国の木箱からアイテムを読み込むとき、rustdocはtraitの実装について質問し、implsに基づいて新しい<code>Item</code>を生成します。その情報に</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This goes directly into the returned <code>Crate</code> rather than roundabout through the <code>DocContext</code> .</span>これは、 <code>DocContext</code>介したラウンドアバウトではなく、返された<code>Crate</code>直接入ります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This way, these implementations can be collected alongside the others, right before rendering the HTML.</span>このように、これらの実装は、HTMLをレンダリングする直前に、他の実装と一緒に収集することができます。</span> </p><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Other tricks up its sleeve</span>袖の上の他のトリック</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">All this describes the process for generating HTML documentation from a Rust crate, but there are couple other major modes that rustdoc runs in. It can also be run on a standalone Markdown file, or it can run doctests on Rust code or standalone Markdown files.</span>これはrustdocが実行するいくつかの主要なモードがあります。スタンドアロンのMarkdownファイルで実行することもできますし、RustコードやスタンドアロンのMarkdownファイルでdoctestを実行することもできます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For the former, it shortcuts straight to <code>html/markdown.rs</code> , optionally including a mode which inserts a Table of Contents to the output HTML.</span>前者の場合、 <code>html/markdown.rs</code>直接ショートカットし、必要に応じて出力HTMLに目次を挿入するモードも含みます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For the latter, rustdoc runs a similar partial-compilation to get relevant documentation in <code>test.rs</code> , but instead of going through the full clean and render process, it runs a much simpler crate walk to grab <i>just</i> the hand-written documentation.</span>後者の場合、rustdocはに関連するドキュメントを取得するために、同様の部分のコンパイルを実行します<code>test.rs</code>が、その代わりに、完全なクリーンを通過するのはプロセスをレンダリングし、それ<i>だけで</i>手書きの文書をつかむためにはるかに簡単なクレート散歩を実行します。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Combined with the aforementioned &quot; <code>find_testable_code</code> &quot; in <code>html/markdown.rs</code> , it builds up a collection of tests to run before handing them off to the libtest test runner.</span> <code>html/markdown.rs</code> <code>find_testable_code</code>の前述の &quot; <code>find_testable_code</code> &quot;と組み合わせて、libtestテストランナーに渡す前に実行する一連のテストをビルドします。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">One notable location in <code>test.rs</code> is the function <code>make_test</code> , which is where hand-written doctests get transformed into something that can be executed.</span> <code>test.rs</code>注目すべき場所は<code>test.rs</code>という関数<code>make_test</code> 。これは手書きのdoctestが実行可能なものに変換される場所です。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Some extra reading about <code>make_test</code> can be found <a class=notranslate href=#2https://quietmisdreavus.net/code/2018/02/23/how-the-doctests-get-made/>here</a> .</span> <code>make_test</code>に関するいくつかの追加情報が<a class=notranslate href=#2https://quietmisdreavus.net/code/2018/02/23/how-the-doctests-get-made/>here</a> 。</span> </p><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Dotting i&#39;s and crossing t&#39;s</span>私はドットをつけています。</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">So that&#39;s rustdoc&#39;s code in a nutshell, but there&#39;s more things in the repo that deal with it.</span>つまり、rustdocのコードは要点ですが、それを扱うレポにはもっと多くのものがあります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Since we have the full <code>compiletest</code> suite at hand, there&#39;s a set of tests in <code>src/test/rustdoc</code> that make sure the final HTML is what we expect in various situations.</span> <code>compiletest</code>な<code>compiletest</code>スイートがあるので、 <code>src/test/rustdoc</code>は一連のテストがあり、さまざまな状況で最終的なHTMLを期待しています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These tests also use a supplementary script, <code>src/etc/htmldocck.py</code> , that allows it to look through the final HTML using XPath notation to get a precise look at the output.</span>これらのテストでは、補足スクリプト<code>src/etc/htmldocck.py</code>も使用しています。これは、出力を正確に見るためにXPath表記を使用して最終HTMLを調べることができます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The full description of all the commands available to rustdoc tests is in <code>htmldocck.py</code> .</span> rustdocテストで使用できるすべてのコマンドの詳細は、 <code>htmldocck.py</code>して<code>htmldocck.py</code> 。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">In addition, there are separate tests for the search index and rustdoc&#39;s ability to query it.</span>さらに、検索インデックスとrustdocのクエリー機能については、別々のテストがあります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The files in <code>src/test/rustdoc-js</code> each contain a different search query and the expected results, broken out by search tab.</span> <code>src/test/rustdoc-js</code>各ファイルには、それぞれ異なる検索クエリと、期待される結果が検索タブで表示されます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These files are processed by a script in <code>src/tools/rustdoc-js</code> and the Node.js runtime.</span>これらのファイルは、 <code>src/tools/rustdoc-js</code>内のスクリプトとNode.jsランタイムによって処理されます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">These tests don&#39;t have as thorough of a writeup, but a broad example that features results in all tabs can be found in <code>basic.js</code> .</span>これらのテストでは、徹底的な書き出しはありませんが、すべてのタブで結果を表示するという幅広い例は、 <code>basic.js</code>ます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The basic idea is that you match a given <code>QUERY</code> with a set of <code>EXPECTED</code> results, complete with the full item path of each item.</span>基本的な考え方は、指定された<code>QUERY</code>に<code>EXPECTED</code>結果セットをマッチさせ、各アイテムの完全なアイテムパスを指定することです。</span> </p><script>_addload(function(){_setupIW('com');_csi('en','ja','rustdoc.html');});</script>