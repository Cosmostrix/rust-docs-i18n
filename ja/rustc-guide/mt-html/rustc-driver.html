<!DOCTYPE html><html lang=ja-x-mtfrom-en><head><script>(function(){(function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(h){}};this.tick("start",null,a)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var f=0<d?new e(d):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})();}).call(window);
</script><script src="https://translate.googleusercontent.com/translate/releases/twsfe_w_20180723_RC00/r/js/translate_c.js"></script><script>_intlStrings._originalText = "英語の原文テキスト:";_intlStrings._interfaceDirection="ltr";_intlStrings._interfaceAlign="left";_intlStrings._langpair="en|ja";_intlStrings._feedbackUrl="https://translate.google.com/translate_suggestion";_intlStrings._currentBy="%1$s に %2$s により翻訳されました";_intlStrings._unknown="不明";_intlStrings._suggestTranslation="翻訳を改善する"  ;_intlStrings._submit="送信";_intlStrings._suggestThanks="Google 翻訳の改善にご協力いただきありがとうございました。";_intlStrings._reverse=false;_intlStrings._staticContentPath="https://www.gstatic.com/translate/infowindow/";</script><style type="text/css">.google-src-text {display: none !important} .google-src-active-text {display: block!important;color:black!important; font-size:12px!important;font-family:arial,sans-serif!important}.google-src-active-text a {font-size:12px!important}.google-src-active-text a:link {color:#00c!important;text-decoration:underline!important}.google-src-active-text a:visited {color:purple!important;text-decoration:underline!important}.google-src-active-text a:active {color:red!important;text-decoration:underline!important}</style><meta http-equiv="X-Translated-By" content="Google"><link href=rustc-driver.html hreflang=en rel="alternate machine-translated-from"><base href="" target=_top /></head><body><iframe src="https://translate.google.com/translate_un?hl=ja&prev=_t&sl=en&tl=ja&lang=en&usg=ALkJrhi1BDLmdbWiRXYMNxkaJ7TdmUrvmA" width=0 height=0 frameborder=0 style="width:0px;height:0px;border:0px;display:none;"></iframe><h1> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The Rustc Driver</span> Rustcドライバー</span> </h1><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <a class=notranslate href="#4`rustc_driver`">`rustc_driver`</a> is essentially <code>rustc</code> &#39;s <code>main()</code> function.</span> <a class=notranslate href="#4`rustc_driver`">`rustc_driver`</a>は本質的には<code>rustc</code>の<code>main()</code>関数です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">It acts as the glue for running the various phases of the compiler in the correct order, managing state such as the <a class=notranslate href="#4`CodeMap`">`CodeMap`</a> \(maps AST nodes to source code), <a class=notranslate href="#4`Session`">`Session`</a> \(general build context and error messaging) and the <a class=notranslate href="#4`TyCtxt`">`TyCtxt`</a> \(the &quot;typing context&quot;, allowing you to query the type system and other cool stuff).</span>これは、 <a class=notranslate href="#4`CodeMap`">`CodeMap`</a> \（ASTノードをソースコードにマップする）、 <a class=notranslate href="#4`Session`">`Session`</a> \（一般的なビルドコンテキストとエラーメッセージング）、および<a class=notranslate href="#4`TyCtxt`">`TyCtxt`</a> \（タイプの文脈、タイプシステムと他のクールなものを照会できるようにする&quot;タイピングコンテキスト &quot;）。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>rustc_driver</code> crate also provides external users with a method for running code at particular times during the compilation process, allowing third parties to effectively use <code>rustc</code> &#39;s internals as a library for analysing a crate or emulating the compiler in-process (eg the RLS).</span> <code>rustc_driver</code>クレートは、コンパイルプロセス中に特定の時間にコードを実行する方法を外部ユーザーに提供し、サードパーティが<code>rustc</code>を解析するライブラリやインプロセスでコンパイラをエミュレートするためのライブラリとして<code>rustc</code>の内部を効果的に使用できるようにします（RLSなど） 。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For those using <code>rustc</code> as a library, the <code>run_compiler()</code> function is the main entrypoint to the compiler.</span>ライブラリとして<code>rustc</code>を使用している場合、 <code>run_compiler()</code>関数はコンパイラのメインエントリポイントです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Its main parameters are a list of command-line arguments and a reference to something which implements the <code>CompilerCalls</code> trait.</span>その主なパラメータは、コマンドライン引数のリストと<code>CompilerCalls</code>特性を実装するものへの参照です。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A <code>CompilerCalls</code> creates the overall <code>CompileController</code> , letting it govern which compiler passes are run and attach callbacks to be fired at the end of each phase.</span> <code>CompilerCalls</code>は全体的な<code>CompileController</code>作成し、どのコンパイラパスが実行されているかを管理し、各フェーズの最後にコールバックを起動するようにします。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">From <code>rustc_driver</code> &#39;s perspective, the main phases of the compiler are:</span> <code>rustc_driver</code>の観点から見ると、コンパイラの主なフェーズは次のとおりです。</span> </p><br><div data-b=1.> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><i>Parse Input:</i> Initial crate parsing</span> <i>パース入力：</i>初期クレート解析</span> </div><div data-b=2.> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><i>Configure and Expand:</i> Resolve <code>#[cfg]</code> attributes, name resolution, and expand macros</span> <i>設定と展開：</i> <code>#[cfg]</code>属性、名前解決、およびマクロの展開を解決する</span> </div><div data-b=3.> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><i>Run Analysis Passes:</i> Run trait resolution, typechecking, region checking and other miscellaneous analysis passes on the crate</span> <i>解析パスを</i>実行する<i>：</i>クレートの特性<i>解析</i> 、型チェック、領域検査、その他のその他の解析パスを実行する</span> </div><div data-b=4.> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><i>Translate to LLVM:</i> Translate to the in-memory form of LLVM IR and turn it into an executable/object files</span> <i>LLVMに翻訳する：</i> LLVM IRのインメモリ形式に変換し、それを実行可能ファイル/オブジェクトファイルに変換する</span> </div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>CompileController</code> then gives users the ability to inspect the ongoing compilation process</span> <code>CompileController</code>は、ユーザーに進行中のコンパイルプロセスを検査する機能を提供します</span> </p><br><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">after parsing</span>解析後</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">after AST expansion</span> AST拡張後</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">after HIR lowering</span> HIR低下後</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">after analysis, and</span>分析後、および</span> </div><div data-b=-> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">when compilation is done</span>編集が終わったら</span> </div><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>CompileState</code> &#39;s various <code>state_after_*()</code> constructors can be inspected to determine what bits of information are available to which callback.</span> <code>CompileState</code>のさまざまな<code>state_after_*()</code>コンストラクタを調べることで、どのコールビットにどの情報ビットが利用可能かを判断できます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For a more detailed explanation on using <code>rustc_driver</code> , check out the <a class=notranslate href=#4stupid-stats>stupid-stats</a> guide by <code>@nrc</code> (attached as <a class=notranslate href="#4Appendix A">Appendix A</a> ).</span> <code>rustc_driver</code>詳細については、 <code>rustc_driver</code> <a class=notranslate href=#4stupid-stats>stupid-stats</a> guideを<code>@nrc</code>て<a class=notranslate href="#4Appendix A">Appendix A</a> （ <a class=notranslate href="#4Appendix A">Appendix A</a>参照）。</span> </p><br><blockquote><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><b>Warning:</b> By its very nature, the internal compiler APIs are always going to be unstable.</span> <b>警告：</b>本質的に、内部コンパイラAPIは常に不安定になります。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">That said, we do try not to break things unnecessarily.</span>しかし、私たちは不必要に物事を壊さないようにしています。</span> </p></blockquote><br><h2> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">A Note On Lifetimes</span>生涯に関する注意</span> </h2><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The Rust compiler is a fairly large program containing lots of big data structures (eg the AST, HIR, and the type system) and as such, arenas and references are heavily relied upon to minimize unnecessary memory use.</span> Rustコンパイラは、大量のデータ構造（AST、HIR、型システムなど）を含むかなり大きなプログラムであり、不要なメモリの使用を最小限に抑えるために、アリーナや参照に大きく依存しています。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">This manifests itself in the way people can plug into the compiler, preferring a &quot;push&quot;-style API (callbacks) instead of the more Rust-ic &quot;pull&quot; style (think the <code>Iterator</code> trait).</span>これは、人々がコンパイラにプラグインできる方法で明らかになり、Rust-icの「プル」スタイル（ <code>Iterator</code>特性を考える）の代わりに「プッシュ」スタイルのAPI（コールバック）を好みます。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">For example the <a class=notranslate href="#4`CompileState`">`CompileState`</a> , the state passed to callbacks after each phase, is essentially just a box of optional references to pieces inside the compiler.</span>たとえば、各段階の後にコールバックに渡される状態である<a class=notranslate href="#4`CompileState`">`CompileState`</a>は、本質的に、コンパイラ内の部分へのオプション参照のボックスです。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The lifetime bound on the <code>CompilerCalls</code> trait then helps to ensure compiler internals don&#39;t &quot;escape&quot; the compiler (eg if you tried to keep a reference to the AST after the compiler is finished), while still letting users record <i>some</i> state for use after the <code>run_compiler()</code> function finishes.</span>上に結合寿命<code>CompilerCalls</code>特色は、（あなたはコンパイラが終了した後にASTへの参照を保持しようとした場合など）の後に、まだせ、ユーザーが使用するために<i>、いくつかの</i>状態を記録しながら、コンパイラを「エスケープ」していないコンパイラの内部を確認するのに役立ちます<code>run_compiler()</code>関数が終了します。</span> </p><br><p> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">Thread-local storage and interning are used a lot through the compiler to reduce duplication while also preventing a lot of the ergonomic issues due to many pervasive lifetimes.</span>スレッドローカルストレージとインターンは、多くの普及している生涯に起因する人間工学的な問題の多くを防ぐと同時に、重複を減らすためにコンパイラを介して多く使用されます。</span> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left">The <code>rustc::ty::tls</code> module is used to access these thread-locals, although you should rarely need to touch it.</span> <code>rustc::ty::tls</code>モジュールは、これらのスレッドローカルにアクセスするために使用されますが、ほとんど触れる必要はありません。</span> </p><br><br> <span class="notranslate" onmouseover="_tipon(this)" onmouseout="_tipoff()"><span class="google-src-text" style="direction: ltr; text-align: left"><a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_driver/>`rustc_driver`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_driver/driver/struct.CompileState.html>`CompileState`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html>`Session`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/ty/struct.TyCtxt.html>`TyCtxt`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html>`CodeMap`</a> <a class=notranslate href=#1https://github.com/nrc/stupid-stats>stupid-stats</a> <a class=notranslate href=#1appendix/stupid-stats.html>Appendix A</a></span> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_driver/>`rustc_driver`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc_driver/driver/struct.CompileState.html>`CompileState`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/session/struct.Session.html>`Session`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/rustc/ty/struct.TyCtxt.html>`TyCtxt`</a> <a class=notranslate href=#1https://doc.rust-lang.org/nightly/nightly-rustc/syntax/codemap/struct.CodeMap.html>`CodeMap`</a> <a class=notranslate href=#1https://github.com/nrc/stupid-stats>stupid-stats</a> <a class=notranslate href=#1appendix/stupid-stats.html>Appendix A</a></span><script>_addload(function(){_setupIW('com');_csi('en','ja','rustc-driver.html');});</script>